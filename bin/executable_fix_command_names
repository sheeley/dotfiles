#! /usr/bin/env bash
set -eu # x

DIR="$(chezmoi source-path)/bin/"
PREFIX="${DIR}executable_"
FROM="-"
TO="_"

for FILE in "$PREFIX"*"$FROM"*
do
	COMMAND_NAME=${FILE#"$PREFIX"}
	NEW_COMMAND_NAME=${COMMAND_NAME//$FROM/$TO}
	NEW_NAME="${PREFIX}${NEW_COMMAND_NAME}"

	if [ -e  "$NEW_NAME" ]
	then
		printf >&2 '%s\n' "Warning, skipping $FILE as the renamed version already exists"
		continue
	fi

	set +e
	if rg "$COMMAND_NAME" "$PREFIX"* "$PRIVATE_TOOLS_DIR"; then
		echo "^ potential usage to replace" # add a space to make it obvious
		if get_input "Skip rename?"; then
			continue
		fi
	fi
	set -e

	mv -- "$FILE" "$NEW_NAME"
	echo "renamed $COMMAND_NAME to $NEW_COMMAND_NAME"

done
